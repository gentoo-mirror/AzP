--- a/vinagre-3.14.3/plugins/rdp/vinagre-rdp-tab.c	2014-12-15 04:21:54.000000000 -0800
+++ b/vinagre-3.14.3/plugins/rdp/vinagre-rdp-tab.c	2015-05-15 23:33:52.662120950 -0700
@@ -880,7 +880,6 @@
   settings->RdpSecurity = TRUE;
   settings->TlsSecurity = TRUE;
   settings->NlaSecurity = TRUE;
-  settings->DisableEncryption = FALSE;
   settings->EncryptionMethods = ENCRYPTION_METHOD_40BIT | ENCRYPTION_METHOD_128BIT | ENCRYPTION_METHOD_FIPS;
   settings->EncryptionLevel = ENCRYPTION_LEVEL_CLIENT_COMPATIBLE;
 #else
@@ -892,6 +891,13 @@
   settings->encryption_level = ENCRYPTION_LEVEL_CLIENT_COMPATIBLE;
 #endif
 
+#include <freerdp/version.h>
+#if (FREERDP_VERSION_MAJOR == 1 && FREERDP_VERSION_MINOR >= 2 && FREERDP_VERSION_REVISION >= 1)
+  settings->UseRdpSecurityLayer = FALSE;
+#elif HAVE_FREERDP_1_1
+  settings->DisableEncryption = FALSE;
+#endif
+
   /* Set display size */
 #if HAVE_FREERDP_1_1
   settings->DesktopWidth = width;
